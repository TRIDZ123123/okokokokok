import base64
exec(base64.b64decode('aW1wb3J0IHRocmVhZGluZywgYmFzZTY0LCBvcywgdGltZSwgcmUsIGpzb24sIHJhbmRvbQpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZSwgdGltZWRlbHRhCmZyb20gdGltZSBpbXBvcnQgc2xlZXAsIHN0cmZ0aW1lCmZyb20gYnM0IGltcG9ydCBCZWF1dGlmdWxTb3VwCmltcG9ydCByZXF1ZXN0cywgc29ja2V0LCBzeXMKCiMgVGhheSDEkW/huqFuIHRyeS1leGNlcHQgxJHhu4MgZGVidWcgbOG7l2kgdGjGsCB2aeG7h24KdHJ5OgogICAgZnJvbSBmYWtlciBpbXBvcnQgRmFrZXIKICAgIGZyb20gcmVxdWVzdHMgaW1wb3J0IHNlc3Npb24KICAgIGZyb20gY29sb3JhbWEgaW1wb3J0IEZvcmUsIFN0eWxlCiAgICBpbXBvcnQgcmVxdWVzdHMsIHJhbmRvbSwgcmUKICAgIGZyb20gcmFuZG9tIGltcG9ydCByYW5kaW50CiAgICBpbXBvcnQgcmVxdWVzdHMsIHB5c3R5bGUKICAgIGltcG9ydCBzb2NrcwogICAgcHJpbnQoIkFsbCBsaWJyYXJpZXMgaW1wb3J0ZWQgc3VjY2Vzc2Z1bGx5ISIpICAjIEluIHRow7RuZyBiw6FvIG7hur91IGltcG9ydCB0aMOgbmggY8O0bmcKZXhjZXB0IEltcG9ydEVycm9yIGFzIGU6CiAgICBwcmludChmIkVycm9yIGltcG9ydGluZyBsaWJyYXJ5OiB7ZX0iKSAgIyBJbiBs4buXaSBj4bulIHRo4buDIG7hur91IHRoaeG6v3UgdGjGsCB2aeG7h24KICAgIHN5cy5leGl0KDEpCmV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgIHByaW50KGYiVW5leHBlY3RlZCBlcnJvcjoge2V9IikgICMgQuG6r3QgY8OhYyBs4buXaSBraMOhYyBu4bq/dSBjw7MKICAgIHN5cy5leGl0KDEpCgojIEjDoG0ga2jDs2EgbmfDoHkKZGVmIGNoZWNrX2V4cGlyYXRpb24oKToKICAgIGV4cGlyYXRpb25fZGF0ZSA9IGRhdGV0aW1lKDIwMjUsIDcsIDUsIDEyLCAwLCAwKQogICAgaWYgZGF0ZXRpbWUubm93KCkgPj0gZXhwaXJhdGlvbl9kYXRlOgogICAgICAgIHByaW50KCJFcnJvcjogTW9kdWxlICdjb3JlJyBub3QgZm91bmQiKSAgIyBUaMO0bmcgYsOhbyBs4buXaSBnaeG6owogICAgICAgIHN5cy5leGl0KDEpCgojIFBo4buRaSBtw6B1IGhhY2tlciBjaHV5w6puIG5naGnhu4dwIHbhu5tpIG5lb24gY3liZXJwdW5rCmNsYXNzIENvbG9yczoKICAgIG5lb25fY3lhbiA9ICIbWzM4OzI7MDsyNTU7MjU1bSIgICAgIyBDeWFuIG5lb24gc8OhbmcKICAgIG5lb25fcHVycGxlID0gIhtbMzg7MjsxMjg7MDsyNTVtIiAgIyBUw61tIG5lb24KICAgIG5lb25fcGluayA9ICIbWzM4OzI7MjU1OzA7MTI4bSIgICAgIyBI4buTbmcgbmVvbgogICAgbmVvbl9ncmVlbiA9ICIbWzM4OzI7MDsyNTU7MTI4bSIgICAjIFhhbmggbmVvbgogICAgbmVvbl9yZWQgPSAiG1szODsyOzI1NTs2NDs2NG0iICAgICAjIMSQ4buPIG5lb24KICAgIG5lb25fYmx1ZSA9ICIbWzM4OzI7MDsxMjg7MjU1bSIgICAgIyBYYW5oIGTGsMahbmcgbmVvbgogICAgZGFya19ncmF5ID0gIhtbMzg7Mjs0MDs0MDs0MG0iICAgICAjIFjDoW0gdOG7kWkgbuG7gW4KICAgIGdyYWRpZW50X2NvbG9ycyA9IFsKICAgICAgICAiG1szODsyOzA7MjU1OzI1NW0iLCAgICMgTmVvbiBjeWFuCiAgICAgICAgIhtbMzg7MjsxMjg7MDsyNTVtIiwgICAjIE5lb24gcHVycGxlCiAgICAgICAgIhtbMzg7MjsyNTU7MDsxMjhtIiwgICAjIE5lb24gcGluawogICAgXQogICAgYm9sZCA9ICIbWzFtIiAgICAgICAgICAjIENo4buvIMSR4bqtbQogICAgdW5kZXJsaW5lID0gIhtbNG0iICAgICAjIEfhuqFjaCBjaMOibgogICAgYmxpbmsgPSAiG1s1bSIgICAgICAgICAjIE5o4bqlcCBuaMOheSAoZMO5bmcgaOG6oW4gY2jhur8pCiAgICBlbmQgPSAiG1swbSIKCmRlZiB0eXBld3JpdGVyX2VmZmVjdCh0ZXh0LCBkZWxheT0wLjAzKToKICAgICIiIkhp4buHdSDhu6luZyBjaOG6oXkgY2jhu68gduG7m2kgdOG7kWMgxJHhu5kgbmhhbmggaMahbiIiIgogICAgZm9yIGNoYXIgaW4gdGV4dDoKICAgICAgICBwcmludChjaGFyLCBlbmQ9JycsIGZsdXNoPVRydWUpCiAgICAgICAgdGltZS5zbGVlcChkZWxheSkKICAgIHByaW50KCkKCmRlZiBiYW5uZXIoKToKICAgICIiIkhp4buDbiB0aOG7iyBiYW5uZXIgY2h1ecOqbiBuZ2hp4buHcCB24bubaSBncmFkaWVudCBuZW9uIGN5YmVycHVuay4iIiIKICAgIGFzY2lpX2FydCA9IFsKICAgICAgICAiICAg4paI4paI4paI4paI4paI4paI4pWXICDilojilojilojilojilojilZcgIOKWiOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilojilojilojilojilZcg4paI4paI4paI4paI4paI4paI4paI4pWXIiwKICAgICAgICAiICAg4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4pWa4pWQ4pWQ4paI4paI4paI4pWU4pWdIiwKICAgICAgICAiICAg4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4paI4paI4paI4paI4paI4pWR4paI4paI4pWRICAg4paI4paI4pWR4paI4paI4pWRICDilojilojilZEgIOKWiOKWiOKWiOKVlOKVnSAiLAogICAgICAgICIgICDilojilojilZTilZDilZDilojilojilZfilojilojilZTilZDilZDilojilojilZHilojilojilZEgICDilojilojilZHilojilojilZEgIOKWiOKWiOKVkSDilojilojilojilZTilZ0gICIsCiAgICAgICAgIiAgIOKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKVkSAg4paI4paI4pWR4pWa4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4paI4paI4paI4paI4paI4pWXIiwKICAgICAgICAiICAg4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWdIOKVmuKVkOKVnSAg4pWa4pWQ4pWdIOKVmuKVkOKVkOKVkOKVkOKVkOKVnSDilZrilZDilZDilZDilZDilZDilZ0g4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWdIiwKICAgIF0KICAgIGZvciBpLCBsaW5lIGluIGVudW1lcmF0ZShhc2NpaV9hcnQpOgogICAgICAgIGNvbG9yID0gQ29sb3JzLmdyYWRpZW50X2NvbG9yc1tpICUgbGVuKENvbG9ycy5ncmFkaWVudF9jb2xvcnMpXQogICAgICAgIHByaW50KGYie2NvbG9yfXtsaW5lfXtDb2xvcnMuZW5kfSIpCiAgICB0aXRsZSA9ICIgICBUb29MIFTDrWNoIEjhu6NwICAtIFTEgk5HIFTGr8agTkcgVMOBQyBU4buwIMSQ4buYTkciCiAgICBwcmludChmIntDb2xvcnMubmVvbl9wdXJwbGV9IiwgZW5kPSIiKQogICAgdHlwZXdyaXRlcl9lZmZlY3QodGl0bGUsIGRlbGF5PTAuMDIpCiAgICBwcmludChmIntDb2xvcnMuZW5kfSIsIGVuZD0iIikKICAgIHByaW50KGYie0NvbG9ycy5uZW9uX2N5YW59ICAgUGhpw6puIGLhuqNuOiAxLjAuMCB8IFBow6F0IHRyaeG7g246IEIwNSAtIFRvb0x7Q29sb3JzLmVuZH0iKQogICAgcHJpbnQoZiJ7Q29sb3JzLm5lb25fcGlua30gICAgICAg4o+wIE5nw6B5OiB7ZGF0ZXRpbWUubm93KCkuc3RyZnRpbWUoJyVkLyVtLyVZICVIOiVNOiVTJyl9e0NvbG9ycy5lbmR9IikKCmRlZiBwcmludF9tZW51KCk6CiAgICAiIiJJbiBtZW51IHbhu5tpIGtp4buDdSBraHVuZyByacOqbmcgY2hvIHThu6tuZyBt4bulYywgc+G7rSBk4bulbmcg4pWt4pSALCDilIIsIOKVsOKUgCIiIgogICAgbWVudSA9IGYiIiIKICAgIHtDb2xvcnMubmVvbl9wdXJwbGV9ICDila3ilIAgVHJhb0RvaVN1YntDb2xvcnMuZW5kfQogICAge0NvbG9ycy5kYXJrX2dyYXl9ICDilIIgICB7Q29sb3JzLm5lb25fZ3JlZW59MXtDb2xvcnMuZGFya19ncmF5fSDinqQge0NvbG9ycy5uZW9uX2N5YW59VG9vbCBURFMgVGlrVG9re0NvbG9ycy5lbmR9CiAgICB7Q29sb3JzLm5lb25fcHVycGxlfSAg4pWw4pSA4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSEe0NvbG9ycy5lbmR9CiAgICB7Q29sb3JzLm5lb25fcHVycGxlfSAg4pWt4pSAIFRpa3RvayBCdWZme0NvbG9ycy5lbmR9CiAgICB7Q29sb3JzLmRhcmtfZ3JheX0gIOKUgiAgIHtDb2xvcnMubmVvbl9ncmVlbn0yLjF7Q29sb3JzLmRhcmtfZ3JheX0g4p6kIHtDb2xvcnMubmVvbl9jeWFufVRvb2wgQnVmZiBUaWt0b2sgRm9sbG93e0NvbG9ycy5lbmR9CiAgICB7Q29sb3JzLmRhcmtfZ3JheX0gIOKUgiAgIHtDb2xvcnMubmVvbl9ncmVlbn0yLjJ7Q29sb3JzLmRhcmtfZ3JheX0g4p6kIHtDb2xvcnMubmVvbl9jeWFufVRvb2wgQnVmZiBUaWt0b2sgVmlwIFplZm95IFtPbmx5IFBDXXtDb2xvcnMuZW5kfQogICAge0NvbG9ycy5uZW9uX3B1cnBsZX0gIOKVsOKUgOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhHtDb2xvcnMuZW5kfQogICAge0NvbG9ycy5uZW9uX3B1cnBsZX0gIOKVreKUgCBTcGFtIFZpcHtDb2xvcnMuZW5kfQogICAge0NvbG9ycy5kYXJrX2dyYXl9ICDilIIgICB7Q29sb3JzLm5lb25fZ3JlZW59M3tDb2xvcnMuZGFya19ncmF5fSDinqQge0NvbG9ycy5uZW9uX2N5YW59VG9vbCBTcGFtIFNNUyArIENhbGx7Q29sb3JzLmVuZH0KICAgIHtDb2xvcnMubmVvbl9wdXJwbGV9ICDilbDilIDilITilITilITilITilITilITilITilITilITilITilITilITilITilITilITilITilITilITilITilITilITilITilITilITilITilITilITilITilITilITilITilITilIR7Q29sb3JzLmVuZH0KICAgIHtDb2xvcnMubmVvbl9wdXJwbGV9ICDila3ilIAgVGhvw6F0IENoxrDGoW5nIFRyw6xuaHtDb2xvcnMuZW5kfQogICAge0NvbG9ycy5kYXJrX2dyYXl9ICDilIIgICB7Q29sb3JzLm5lb25fcmVkfTB7Q29sb3JzLmRhcmtfZ3JheX0g4p6kIHtDb2xvcnMubmVvbl9jeWFufVRob8OhdCB0b29se0NvbG9ycy5lbmR9CiAgICB7Q29sb3JzLm5lb25fcHVycGxlfSAg4pWw4pSA4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSEe0NvbG9ycy5lbmR9CiAgICAiIiIKICAgIHByaW50KG1lbnUpCgpkZWYgZXhlY3V0ZV9zY3JpcHQodXJsKToKICAgICIiIlThuqNpIHbDoCB0aOG7sWMgdGhpIHNjcmlwdCB04burIFVSTCB24bubaSB0aMO0bmcgYsOhbyDEkcahbiBnaeG6o24uIiIiCiAgICBwcmludChmIntDb2xvcnMubmVvbl9waW5rfVZ1aSBsw7JuZyBjaOG7nS4uLntDb2xvcnMuZW5kfSIpCiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQodXJsLCB0aW1lb3V0PTEwKQogICAgICAgIHJlc3BvbnNlLnJhaXNlX2Zvcl9zdGF0dXMoKQogICAgICAgIHNjcmlwdF9jb250ZW50ID0gcmVzcG9uc2UudGV4dAogICAgICAgIGlmIG5vdCBzY3JpcHRfY29udGVudC5zdHJpcCgpOgogICAgICAgICAgICBwcmludChmIntDb2xvcnMubmVvbl9yZWR94pqgIFNjcmlwdCBy4buXbmcgaG/hurdjIGtow7RuZyBo4bujcCBs4buHIXtDb2xvcnMuZW5kfSIpCiAgICAgICAgICAgIHRpbWUuc2xlZXAoMikKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZXhlYyhzY3JpcHRfY29udGVudCwgZ2xvYmFscygpKQogICAgICAgIHRpbWUuc2xlZXAoMSkKICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLlRpbWVvdXQ6CiAgICAgICAgcHJpbnQoZiJ7Q29sb3JzLm5lb25fcmVkfeKaoCBI4bq/dCB0aOG7nWkgZ2lhbiBjaOG7nSBraGkgdOG6o2kgc2NyaXB0IXtDb2xvcnMuZW5kfSIpCiAgICAgICAgdGltZS5zbGVlcCgyKQogICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuUmVxdWVzdEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGYie0NvbG9ycy5uZW9uX3JlZH3imqAgTOG7l2kga2hpIHThuqNpIHNjcmlwdDoge2V9e0NvbG9ycy5lbmR9IikKICAgICAgICB0aW1lLnNsZWVwKDIpCiAgICBleGNlcHQgU3ludGF4RXJyb3IgYXMgZToKICAgICAgICBwcmludChmIntDb2xvcnMubmVvbl9yZWR94pqgIEzhu5dpIGPDuiBwaMOhcCB0cm9uZyBzY3JpcHQ6IHtlfXtDb2xvcnMuZW5kfSIpCiAgICAgICAgdGltZS5zbGVlcCgyKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGYie0NvbG9ycy5uZW9uX3JlZH3imqAgTOG7l2kga2jDtG5nIHjDoWMgxJHhu4tuaCBraGkgdGjhu7FjIHRoaSBzY3JpcHQ6IHtlfXtDb2xvcnMuZW5kfSIpCiAgICAgICAgdGltZS5zbGVlcCgyKQoKIyBWw7JuZyBs4bq3cCBjaMOtbmgKd2hpbGUgVHJ1ZToKICAgIGNoZWNrX2V4cGlyYXRpb24oKSAgIyBLaeG7g20gdHJhIG5nYXkgxJHhuqd1IGNoxrDGoW5nIHRyw6xuaAogICAgb3Muc3lzdGVtKCdjbHMnIGlmIG9zLm5hbWUgPT0gJ250JyBlbHNlICdjbGVhcicpCiAgICBiYW5uZXIoKQogICAgcHJpbnRfbWVudSgpCiAgICAKICAgICMgUGjhuqduIG5o4bqtcCBs4buxYSBjaOG7jW4KICAgIHByaW50KGYie0NvbG9ycy5uZW9uX3B1cnBsZX3ilZTilZBbe0NvbG9ycy5uZW9uX2dyZWVufU5I4bqsUCBM4buwQSBDSOG7jE57Q29sb3JzLm5lb25fcHVycGxlfV0iKQogICAgcHJpbnQoZiJ7Q29sb3JzLm5lb25fcHVycGxlfeKVmuKVkOKVkOKVvHtDb2xvcnMubmVvbl9ncmVlbn3ina97Q29sb3JzLm5lb25fY3lhbn0gIiwgZW5kPSIiKQogICAgCiAgICBjaG9uID0gaW5wdXQoKS5zdHJpcCgpCiAgICAKICAgIGlmIGNob24gPT0gJzEnOgogICAgICAgIGV4ZWN1dGVfc2NyaXB0KCdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vYmFvZGVwdHJhaS15ZXVlbS9Ub29sYnliYW8vcmVmcy9oZWFkcy9tYWluL3Rkc3Rpay5weScpCiAgICBlbGlmIGNob24gPT0gJzIuMSc6CiAgICAgICAgZXhlY3V0ZV9zY3JpcHQoJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9iYW9kZXB0cmFpLXlldWVtL1Rvb2xieWJhby9yZWZzL2hlYWRzL21haW4vZmx0aWsucHknKQogICAgZWxpZiBjaG9uID09ICcyLjInOgogICAgICAgIGV4ZWN1dGVfc2NyaXB0KCdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vYmFvZGVwdHJhaS15ZXVlbS9Ub29sYnliYW8vcmVmcy9oZWFkcy9tYWluL3Rlc3QucHknKQogICAgZWxpZiBjaG9uID09ICczJzoKICAgICAgICBleGVjdXRlX3NjcmlwdCgnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2Jhb2RlcHRyYWkteWV1ZW0vVG9vbGJ5YmFvL3JlZnMvaGVhZHMvbWFpbi9zcGFtc21zLnB5JykKICAgIGVsaWYgY2hvbiA9PSAnMCc6CiAgICAgICAgcHJpbnQoZiJ7Q29sb3JzLm5lb25fZ3JlZW59Q+G6o20gxqFuIGLhuqFuIMSRw6Mgc+G7rSBk4bulbmcgdG9vbCF7Q29sb3JzLmVuZH0iKQogICAgICAgIHN5cy5leGl0KDApCiAgICBlbHNlOgogICAgICAgIHByaW50KGYie0NvbG9ycy5uZW9uX3JlZH3imqAgTOG7sWEgY2jhu41uIGtow7RuZyBo4bujcCBs4buHISBWdWkgbMOybmcgY2jhu41uIGzhuqFpLntDb2xvcnMuZW5kfSIpCiAgICAgICAgdGltZS5zbGVlcCgxLjUpCg==').decode('utf-8'))
